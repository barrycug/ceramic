<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title></title>
    <style>
    
      article {
        overflow: auto;
        margin: 0.5em;
      }
      
      article canvas {
        display: block;
        float: left;
        margin-right: 0.5em;
        background: #ccc;
      }
      
      article h1 {
        margin-top: 0;
      }
      
    </style>
  </head>
  <body>
    
    <script src="render.js"></script>
    <script>
      
      var TILES = <%= JSON.dump(@tiles) %>;
      
      TILES.forEach(function(tile) {
        
        // create canvas and wrapper with info
        
        var canvas = document.createElement("canvas");
        canvas.width = 512;
        canvas.height = 512;
        
        var article = document.createElement("article");
        article.innerHTML += "<h1>" + tile.filename + "</h1><dl><dt>Size</dt><dd>" + (tile.size / 1000) + " kB</dd><dt>Time</dt><dd>" + tile.time + " s</dd></dl>";
        article.insertBefore(canvas, article.firstChild);
        
        document.body.appendChild(article);
        
        // request tile and render
        
        var request = new XMLHttpRequest();
  
        request.onreadystatechange = function() {
          if (this.readyState == this.DONE) {
            if (this.responseText) {
              
              var data = JSON.parse(this.responseText);
              
              DebugRender.renderTile(canvas, data);
              
            }
          }
          
        }
    
        request.open("GET", tile.filename, true);
        request.send();
        
      });
      
    </script>
    
  </body>
</html>
